"use strict";(self.webpackChunktasks_management=self.webpackChunktasks_management||[]).push([[469],{6469:(D,y,a)=>{a.r(y),a.d(y,{UserAuthenticationModule:()=>S});var c=a(6895),f=a(6264),m=a(1135),C=a(7579),u=a(2722),g=a(9457),e=a(1571),h=a(9646),v=a(4004),b=a(262),M=a(529),F=a(4701);let U=(()=>{class t{constructor(s,r){this.http=s,this.authService=r}login(s){return s?(this.authService.setUserLoginSession(s),(0,h.of)({success:!0})):(0,h.of)({success:!1,message:"There are something wrong with your Email or Password"})}getAllUsers(){return this.http.get("users").pipe((0,v.U)(s=>s),(0,b.K)(s=>(console.log(s),(0,h.of)([]))))}registerUser(s){return this.http.post("users",{method:"POST",body:JSON.stringify({email:s.email,fullname:s.fullname,password:s.password}),headers:{"Content-type":"application/json; charset=UTF-8"}}).pipe((0,v.U)(r=>({success:!0})),(0,b.K)(r=>(console.log(r),(0,h.of)({success:!1,message:"Can not created new User"}))))}}return t.\u0275fac=function(s){return new(s||t)(e.LFG(M.eN),e.LFG(F.$))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();var n=a(433),w=a(9228);function A(t,o){if(1&t){const s=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.cancelLogin())}),e._uU(1," Cancel "),e.qZA()}}const x=[[["","extendActions",""]]],p=function(){return["primary-font-color"]},N=["[extendActions]"];let E=(()=>{class t{constructor(){this.onLogin=new e.vpe,this.canceled=new e.vpe,this.invalidLogin=!0,this.destroyed$=new C.x}ngOnInit(){this.loginForm=new n.cw({email:new n.NI("",[n.kI.required]),password:new n.NI("",[n.kI.required])}),this.onFormChanges()}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.unsubscribe()}login(){this.onLogin.emit(this.loginForm.value)}cancelLogin(){this.loginForm.reset(),this.canceled.emit()}onFormChanges(){this.loginForm.valueChanges.pipe((0,u.R)(this.destroyed$)).subscribe(s=>{this.validateForm(s)})}validateForm(s){s.email&&s.password&&(this.invalidLogin=!1)}}return t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-login"]],inputs:{errorMessage:"errorMessage",showCancelButton:"showCancelButton"},outputs:{onLogin:"onLogin",canceled:"canceled"},ngContentSelectors:N,decls:16,vars:16,consts:[[1,"login-form-header"],[1,"primary-font-color","text-center"],[1,"login-container",3,"formGroup"],[1,"form-control"],["formControlName","email",3,"label","placeholder","labelClassName","inputClassName"],["formControlName","password","type","password",3,"label","placeholder","labelClassName","inputClassName"],[1,"w-100","h-100","flex","f-align-center","flex-space-between"],[1,"right"],[1,"btn","btn-primary","m-r-12",3,"disabled","click"],["class","btn btn-light",3,"click",4,"ngIf"],[1,"w-100","text-align-center","danger-color"],[1,"btn","btn-light",3,"click"]],template:function(s,r){1&s&&(e.F$t(x),e.TgZ(0,"div",0)(1,"h1",1),e._uU(2," LOG IN "),e.qZA()(),e.TgZ(3,"div",2)(4,"div",3),e._UZ(5,"lib-input",4),e.qZA(),e.TgZ(6,"div",3),e._UZ(7,"lib-input",5),e.qZA(),e.TgZ(8,"div",6)(9,"div",7)(10,"button",8),e.NdJ("click",function(){return r.login()}),e._uU(11," Login "),e.qZA(),e.YNc(12,A,2,0,"button",9),e.qZA(),e.Hsn(13),e.qZA()(),e.TgZ(14,"div",10),e._uU(15),e.qZA()),2&s&&(e.xp6(3),e.Q6J("formGroup",r.loginForm),e.xp6(2),e.Q6J("label","Email")("placeholder","Your Email")("labelClassName",e.DdM(12,p))("inputClassName",e.DdM(13,p)),e.xp6(2),e.Q6J("label","Password")("placeholder","Your Password")("labelClassName",e.DdM(14,p))("inputClassName",e.DdM(15,p)),e.xp6(3),e.Q6J("disabled",r.invalidLogin),e.xp6(2),e.Q6J("ngIf",r.showCancelButton),e.xp6(3),e.hij(" ",r.errorMessage," "))},dependencies:[c.O5,w.a,n.JJ,n.JL,n.sg,n.u],styles:["[_nghost-%COMP%]{display:block;padding:20px}"]}),t})();const T=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;class L{static validateEmail(o){return!!o.toLowerCase().match(T)}}class Z{static emailValidator(o){const s=o.value;return s?L.validateEmail(s)?null:{message:"your input for the email is wrong formatted"}:{message:"Missing Email!"}}}function _(t,o){if(1&t){const s=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.onCancel())}),e._uU(1," Cancel "),e.qZA()}}const R=[[["","extendActions",""]]],l=function(){return["primary-font-color"]},$=["[extendActions]"];let k=(()=>{class t{constructor(){this.registryUser=new e.vpe,this.updateUser=new e.vpe,this.checkIsUnique=new e.vpe,this.cancelRegistry=new e.vpe,this.countries=[],this.confirmPassMess$=new m.X({valid:!1,message:"Filled your confirm Password"}),this.confirmPassErrorMess$=new m.X(""),this.invalidEmailErrorMess$=new m.X(""),this.usernameErrorMess$=new m.X(""),this.title="SIGN UP",this.isFormValid=!1,this.destroy$=new C.x}ngOnInit(){this.registryForm=new n.cw({fullname:new n.NI("",[n.kI.required]),password:new n.NI("",[n.kI.required]),confirmPassword:new n.NI("",[n.kI.required]),email:new n.NI("",[n.kI.required,Z.emailValidator])}),this.setDefaultFormValue(),this.listenConfirmPasswordRules(),this.listenEmailChanges(),this.listenFormChanges()}ngOnChanges(s){s&&(s.emailErrorMessage&&this.emailErrorMessage&&(this.invalidEmailErrorMess$.next(this.emailErrorMessage),this.validateForm()),s.currentUser&&this.currentUser&&this.registryForm&&this.setDefaultFormValue())}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}get emailErrorFormatted(){const s=this.registryForm.get("email");return s&&s.errors&&s.errors.message}submitRegistry(){this.registryUser.emit({...this.registryForm.value})}onCancel(){this.registryForm.reset(),this.cancelRegistry.emit()}checkUnique(s){const r=this.registryForm.get(s);if(!r)return;const i=r.value;i&&this.checkIsUnique.emit({key:s,value:i})}setDefaultFormValue(){this.currentUser&&this.registryForm.setValue({fullname:this.currentUser.fullname,password:"",confirmPassword:"",email:this.currentUser.email})}listenFormChanges(){this.registryForm.valueChanges.pipe((0,u.R)(this.destroy$)).subscribe(s=>{this.validateForm()})}validateForm(){this.isFormValid=!1,!this.registryForm.errors&&(this.registryForm.get("email")?.errors||!this.confirmPassMess$.value.valid||this.emailErrorMessage||(this.isFormValid=!0))}listenEmailChanges(){this.registryForm.get("email")?.valueChanges.pipe((0,u.R)(this.destroy$)).subscribe(s=>{const r=this.registryForm.get("email");this.invalidEmailErrorMess$.next(r?.errors?r.errors.message:"")})}listenConfirmPasswordRules(){this.registryForm.get("confirmPassword")?.valueChanges.pipe((0,u.R)(this.destroy$)).subscribe(s=>{const r=this.registryForm.get("password")?.value;if(r!==s){const i="Your Confirm Password does not match with Password";return this.confirmPassMess$.next({message:i,valid:!1}),void this.confirmPassErrorMess$.next(i)}r||s?(this.confirmPassErrorMess$.next(""),this.confirmPassMess$.next({valid:!0,message:"Matched"})):this.confirmPassMess$.next({message:"Filled your confirm Password",valid:!1})})}}return t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-register"]],inputs:{emailErrorMessage:"emailErrorMessage",currentUser:"currentUser",showCancelButton:"showCancelButton"},outputs:{registryUser:"registryUser",updateUser:"updateUser",checkIsUnique:"checkIsUnique",cancelRegistry:"cancelRegistry"},features:[e.TTD],ngContentSelectors:$,decls:19,vars:42,consts:[[1,"registry-form-header"],[1,"primary-font-color","text-center"],[1,"registry-form",3,"formGroup"],["triggerContent","",1,"form-control"],["formControlName","email",3,"label","errorMessage","placeholder","isRequired","labelClassName","inputClassName","blur"],["formControlName","fullname",3,"label","isRequired","maxLength","placeholder","labelClassName","inputClassName"],[1,"form-control"],["formControlName","password",3,"label","isRequired","type","maxLength","placeholder","labelClassName","inputClassName"],["formControlName","confirmPassword","placeholder","Confirm your Password again",3,"label","type","isRequired","maxLength","errorMessage","labelClassName","inputClassName"],[1,"w-100","h-100","flex","flex-align-center","flex-space-between"],[1,"btn","btn-primary","m-r-12",3,"disabled","click"],["class","btn btn-light",3,"click",4,"ngIf"],[1,"btn","btn-light",3,"click"]],template:function(s,r){1&s&&(e.F$t(R),e.TgZ(0,"div",0)(1,"h1",1),e._uU(2),e.qZA()(),e.TgZ(3,"div",2)(4,"div",3)(5,"lib-input",4),e.NdJ("blur",function(){return r.checkUnique("email")}),e.ALo(6,"async"),e.qZA()(),e.TgZ(7,"div",3),e._UZ(8,"lib-input",5),e.qZA(),e.TgZ(9,"div",6),e._UZ(10,"lib-input",7),e.qZA(),e.TgZ(11,"div",3),e._UZ(12,"lib-input",8),e.ALo(13,"async"),e.qZA()(),e.TgZ(14,"div",9)(15,"button",10),e.NdJ("click",function(){return r.submitRegistry()}),e._uU(16," SUBMIT "),e.qZA(),e.YNc(17,_,2,0,"button",11),e.Hsn(18),e.qZA()),2&s&&(e.xp6(2),e.hij(" ",r.title," "),e.xp6(1),e.Q6J("formGroup",r.registryForm),e.xp6(2),e.Q6J("label","Email")("errorMessage",e.lcZ(6,30,r.invalidEmailErrorMess$)||"")("placeholder","johnsmith@gmail.com")("isRequired",!0)("labelClassName",e.DdM(34,l))("inputClassName",e.DdM(35,l)),e.xp6(3),e.Q6J("label","Fullname")("isRequired",!0)("maxLength",40)("placeholder","Your Username")("labelClassName",e.DdM(36,l))("inputClassName",e.DdM(37,l)),e.xp6(2),e.Q6J("label","Password")("isRequired",!0)("type","password")("maxLength",40)("placeholder","Your Password")("labelClassName",e.DdM(38,l))("inputClassName",e.DdM(39,l)),e.xp6(2),e.Q6J("label","Confirm Password")("type","password")("isRequired",!0)("maxLength",40)("errorMessage",e.lcZ(13,32,r.confirmPassErrorMess$)||"")("labelClassName",e.DdM(40,l))("inputClassName",e.DdM(41,l)),e.xp6(3),e.Q6J("disabled",!r.isFormValid),e.xp6(2),e.Q6J("ngIf",r.showCancelButton))},dependencies:[c.O5,w.a,n.JJ,n.JL,n.sg,n.u,c.Ov]}),t})();const J=[{path:"",pathMatch:"full",component:(()=>{class t{constructor(s,r){this.usersService=s,this.router=r,this.loginAnimationClass="slide-right",this.registerAnimationClass="slide-out-right",this.emailErrorMess$=new m.X(""),this.destroyed$=new C.x,this._users=[]}ngOnInit(){this.getAllUsers()}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.unsubscribe()}switchToRegisterForm(){this.registerAnimationClass="slide-left",this.loginAnimationClass="slide-out-left"}switchToLoginForm(){this.loginAnimationClass="slide-right",this.registerAnimationClass="slide-out-right"}checkUnique(s){this._users.find(i=>i[s.key]===s.value)?this.emailErrorMess$.next("This Email is not unique"):this.emailErrorMess$.next("")}onLogin(s){const r=this._users.find(i=>i.email===s.email&&i.password===s.password);this.usersService.login(r).pipe((0,u.R)(this.destroyed$)).subscribe(i=>{i.success?this.router.navigate([""]):g.M.fireAlert({iconType:g.e.Error,message:i.message||"",title:"Login Error!"})})}register(s){this.usersService.registerUser(s).pipe((0,u.R)(this.destroyed$)).subscribe(r=>{if(r.success)return this.switchToLoginForm(),void this._users.push(s);g.M.fireAlert({iconType:g.e.Error,title:"Register Error!",message:r.message?r.message:""})})}getAllUsers(){this.usersService.getAllUsers().pipe((0,u.R)(this.destroyed$)).subscribe(s=>{this._users=[...s]})}}return t.\u0275fac=function(s){return new(s||t)(e.Y36(U),e.Y36(f.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-user-auths"]],decls:11,vars:5,consts:[[1,"login-form","main-background-style","primary-font-color","shadow-drop-box",3,"ngClass"],[3,"onLogin"],["extendActions","",1,"flex","flex-align-center"],[1,"register-action","pointer",3,"click"],[1,"register-form","main-background-style","primary-font-color","shadow-drop-box",3,"ngClass"],[3,"emailErrorMessage","checkIsUnique","registryUser"],[1,"pointer",3,"click"]],template:function(s,r){1&s&&(e.TgZ(0,"div",0)(1,"app-login",1),e.NdJ("onLogin",function(d){return r.onLogin(d)}),e.TgZ(2,"div",2)(3,"span",3),e.NdJ("click",function(){return r.switchToRegisterForm()}),e._uU(4," Registry an account "),e.qZA()()()(),e.TgZ(5,"div",4)(6,"app-register",5),e.NdJ("checkIsUnique",function(d){return r.checkUnique(d)})("registryUser",function(d){return r.register(d)}),e.ALo(7,"async"),e.TgZ(8,"div",2)(9,"span",6),e.NdJ("click",function(){return r.switchToLoginForm()}),e._uU(10," Login? "),e.qZA()()()()),2&s&&(e.Q6J("ngClass",r.loginAnimationClass),e.xp6(5),e.Q6J("ngClass",r.registerAnimationClass),e.xp6(1),e.Q6J("emailErrorMessage",e.lcZ(7,3,r.emailErrorMess$)||""))},dependencies:[c.mk,E,k,c.Ov],styles:["[_nghost-%COMP%]{display:block;position:relative;width:100%;height:100%}.login-form[_ngcontent-%COMP%]{padding:20px 50px;border-radius:10px;position:absolute;top:25%;left:35%;width:30%}.register-form[_ngcontent-%COMP%]{padding:20px 50px;position:absolute;top:20%;left:35%;width:30%}"]}),t})()}];let P=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[f.Bz.forChild(J),f.Bz]}),t})();var I=a(1409);let q=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[c.ez,I.u,n.UX]}),t})(),S=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[U],imports:[c.ez,P,q]}),t})()}}]);